CREATE SCHEMA DATA_CHALLENGE;
CREATE TABLE DATA_CHALLENGE.ITEM (I_ITEM_SK SMALLINT , I_ITEM_ID CHAR(16) , I_REC_START_DATE DATE, I_REC_END_DATE DATE, I_ITEM_DESC VARCHAR(200), I_CURRENT_PRICE DECIMAL(7,2), I_WHOLESALE_COST DECIMAL(7,2), I_BRAND_ID INTEGER, I_BRAND CHAR(50), I_CLASS_ID INTEGER, I_CLASS CHAR(50), I_CATEGORY_ID INTEGER, I_CATEGORY CHAR(50), I_MANUFACT_ID INTEGER, I_MANUFACT CHAR(50), I_SIZE CHAR(20), I_FORMULATION CHAR(20), I_COLOR CHAR(20), I_UNITS CHAR(10), I_CONTAINER CHAR(10), I_MANAGER_ID INTEGER, I_PRODUCT_NAME CHAR(50), DISTRIBUTE BY I_ITEM_SK);
CREATE TABLE DATA_CHALLENGE.CUSTOMER (C_CUSTOMER_SK SMALLINT , C_CUSTOMER_ID CHAR(16) , C_CURRENT_CDEMO_SK SMALLINT, C_CURRENT_HDEMO_SK SMALLINT, C_CURRENT_ADDR_SK SMALLINT, C_FIRST_SHIPTO_DATE_SK SMALLINT, C_FIRST_SALES_DATE_SK SMALLINT, C_SALUTATION CHAR(10), C_FIRST_NAME CHAR(20), C_LAST_NAME CHAR(30), C_PREFERRED_CUST_FLAG CHAR(1), C_BIRTH_DAY INTEGER, C_BIRTH_MONTH INTEGER, C_BIRTH_YEAR INTEGER, C_BIRTH_COUNTRY VARCHAR(20), C_LOGIN CHAR(13), C_EMAIL_ADDRESS CHAR(50), C_LAST_REVIEW_DATE_SK SMALLINT, DISTRIBUTE BY C_CUSTOMER_SK);
CREATE TABLE DATA_CHALLENGE.HOUSEHOLD_DEMOGRAPHICS (HD_DEMO_SK SMALLINT , HD_INCOME_BAND_SK SMALLINT, HD_BUY_POTENTIAL CHAR(15), HD_DEP_COUNT INTEGER, HD_VEHICLE_COUNT INTEGER, DISTRIBUTE BY   HD_DEMO_SK);
CREATE TABLE DATA_CHALLENGE.WEB_SALES (WS_SOLD_DATE_SK SMALLINT, WS_SOLD_TIME_SK SMALLINT, WS_SHIP_DATE_SK SMALLINT, WS_ITEM_SK SMALLINT , WS_BILL_CUSTOMER_SK SMALLINT, WS_BILL_CDEMO_SK SMALLINT, WS_BILL_HDEMO_SK SMALLINT, WS_BILL_ADDR_SK SMALLINT, WS_SHIP_CUSTOMER_SK SMALLINT, WS_SHIP_CDEMO_SK SMALLINT, WS_SHIP_HDEMO_SK SMALLINT, WS_SHIP_ADDR_SK SMALLINT, WS_WEB_PAGE_SK SMALLINT, WS_WEB_SITE_SK SMALLINT, WS_SHIP_MODE_SK SMALLINT, WS_WAREHOUSE_SK SMALLINT, WS_PROMO_SK SMALLINT, WS_ORDER_NUMBER INTEGER , WS_QUANTITY INTEGER, WS_WHOLESALE_COST DECIMAL(7,2), WS_LIST_PRICE DECIMAL(7,2), WS_SALES_PRICE DECIMAL(7,2), WS_EXT_DISCOUNT_AMT DECIMAL(7,2), WS_EXT_SALES_PRICE DECIMAL(7,2), WS_EXT_WHOLESALE_COST DECIMAL(7,2), WS_EXT_LIST_PRICE DECIMAL(7,2), WS_EXT_TAX DECIMAL(7,2), WS_COUPON_AMT DECIMAL(7,2), WS_EXT_SHIP_COST DECIMAL(7,2), WS_NET_PAID DECIMAL(7,2), WS_NET_PAID_INC_TAX DECIMAL(7,2), WS_NET_PAID_INC_SHIP DECIMAL(7,2), WS_NET_PAID_INC_SHIP_TAX DECIMAL(7,2), WS_NET_PROFIT DECIMAL(7,2), DISTRIBUTE BY   WS_ITEM_SK);
CREATE OR REPLACE CONNECTION S3_DATA_CHALLENGE
TO 'http://exa-data-challenge.s3-eu-central-1.amazonaws.com'; 